# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TypeScript, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## **Архитектура приложения**

<!-- ![alt text](./src/images/readme/image.png) -->

## Базовый код

### **1. Класс `EventEmitter`**

Реализует паттерн «MVP» и позволяет подписываться на события и уведомлять подписчиков
о наступлении события.

Класс имеет методы `on`, `off`, `emit` — для подписки на событие, отписки от события и уведомления
подписчиков о наступлении события соответственно.

Дополнительно реализованы методы `onAll` и `offAll` — для подписки на все события и сброса всех
подписчиков.

Ещё одним дополнением является метод `trigger`, генерирующий заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти
классы будут генерировать события, не будучи при этом напрямую зависимыми от
класса `EventEmitter`.


### **2. Класс `Api`**

Реализует отправку запросов серверу, получает данные с сервера.

Конструктор принимает два аргумента - `baseURL: string` (базовый URL) и `options: RequestInit` (объект с заголовками; по умолчанию включает заголовок Content-Type: application/json).

Класс имеет публичные методы `get()` и `post()`.
- `get(uri: string):` отправляет запрос методом GET по указанному URI и возвращает данные (или ошибку) в виде промиса.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST'):` отправляет данные (data) методом POST/PUT/DELETE по указанному URI и возвращает ответ в виде промиса.

Дополнительно реализован защищённый метод `handleResponse`— для обработки ответа сервера. Если ответ успешный, возвращает данные. В противном случае возвращает ошибку, если она присутствует.

---

## **Компоненты модели данных**

### **1. Объект с интерфейсом `IProduct`**
Является частью модели данных. Хранит в себе информацию о товаре:
- `id: string` - Идентификатор товара;
- `category: string` - Категория товара;
- `name: string` - Название товара;
- `description: string` - Описание товара;
- `image: string` - Путь к изображению (string);
- `price: number` - Цена товара;

---
  
### **2. Класс `CatalogModel`**

Содержит список товаров в каталоге (`items: IProduct[]`). В компоненте реализованы следующие методы: 
- `setItems(items: IProduct[]): void` - для установки товаров после загрузки из API;
- `getProduct(id: string): IProduct | null`- для получения товара по id;

---

### **3. Класс `CartModel`**

Содержит список товаров в корзине (`items: IProduct[]`). В компоненте реализованы следующие методы: 
- `add(id: string): void` - для добавления товара в корзину по id товара;
- `remove(id: string): void`- для удаления товара из корзины по id товара;
- `clearCart(): void` - очистить корзину;
- `getList(): Map<string, number>` - получает список товаров в корзине;

---

### **4. Класс `BuyerData`**

Содержит данные покупателя и методы работы с ними.
- `email: string` - почта покупателя;
- `phone: string` - телефон покупателя;
- `address: string` - адрес покупателя;
- `paymentMethod: string` - выбранный способ оплаты;

Методы:
- `selectPaymentMethod(method: string): void` - выбор способа оплаты;
- `selectAddress(address: string): void` - указание адреса;
- `provideContactInfo(email: string, phone: string): void` - указание почты и телефона;
- `clearData(): void` - очистка данных;


## **Компоненты представления**

### **1. Класс `CartItemView`**
Отображает карточки товаров в корзине.
- `title: HTMLSpanElement` - Заголовок товара в корзине;
- `price: HTMLSpanElement` - Цена товара в корзине;
- `removeButton: HTMLButtonElement` - Кнопка удаления товара из корзины;
- `id: string | null` - ID товара (по умолчанию null);

Конструктор принимает контейнер (корзину) и объект IEvents для работы с событиями.
В конструкторе инициализируются поля (осуществляется поиск элементов), устанавливаются слушатели событий.

Метод:
- `render (data: { id: string, title: string})` - Если есть новые данные, то
метод запоминает их и выводит в интерфейс.

### **2. Класс `BaseView`**
Представляет собой абстрактный базовый класс, реализующий интерфейс IView. 
Служит основой для других классов представления.

- `render(data?: object): HTMLElement` - Принимает массив HTML-элементов. Внутри метода проверяется наличие данных. 
Если данные присутствуют, текущий контейнер очищается с помощью метода replaceChildren, и в него добавляются элементы из массива `data.items`.
Метод возвращает обновленный контейнер, который теперь содержит новые элементы.

### **3. Класс `CartView`**
Отображает корзину. Наследуется от абстрактного класса `BaseView`.

### **4. Класс `CatalogView`**
Отображает каталог. Наследуется от абстрактного класса `BaseView`.

### **5. Класс `ProductPreview`**
Отображает информацию о товаре в режиме предпросмотра.

### **6. Класс `OrderFormView`**
Отображает форму при оформлении заказа, управляет состояниями формы.

### **7. Класс `SuccessfulDialog`**
В формате модального окна уведомляет пользователя о том, что заказ был успешно оформлен.